/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/++plone++senaite.patient.static/bundles";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./components/temporaryidentifierwidget.coffee":
/*!*****************************************************!*\
  !*** ./components/temporaryidentifierwidget.coffee ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ \"jquery\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar TemporaryIdentifierWidgetController;\n\n\nTemporaryIdentifierWidgetController = /*#__PURE__*/function () {\n  function TemporaryIdentifierWidgetController() {\n    _classCallCheck(this, TemporaryIdentifierWidgetController);\n\n    /*\n    Reset value_auto from all identifier widgets and value from identifier widgets\n    that are temporary\n    */\n    this.reset_values = this.reset_values.bind(this);\n    /*\n    Reset the value for the given element\n    */\n\n    this.reset_value = this.reset_value.bind(this);\n    this.bind_event_handler = this.bind_event_handler.bind(this);\n    /*\n    Event handler for TemporaryIdentifier's checkbox change\n    */\n\n    this.on_temporary_change = this.on_temporary_change.bind(this);\n    /*\n    Event handler for TemporaryIdentifier's value change\n    */\n\n    this.on_value_change = this.on_value_change.bind(this);\n    /*\n    Event handler for TemporaryIdentifier's value change\n    */\n\n    this.on_keypress = this.on_keypress.bind(this);\n    /*\n    Sets the temporary value of te field\n    */\n\n    this.set_temporary = this.set_temporary.bind(this);\n    /*\n    Sets the current id value of the field\n    */\n\n    this.set_current_id = this.set_current_id.bind(this);\n    /*\n    Returns the current id value of the field\n    */\n\n    this.get_current_id = this.get_current_id.bind(this);\n    /*\n    Returns the id value that is/was auto-generated for the field\n    */\n\n    this.get_autogenerated_id = this.get_autogenerated_id.bind(this);\n    /*\n    Returns the input element for manual introduction of an identifier value\n    */\n\n    this.get_input_element = this.get_input_element.bind(this);\n    /*\n    Returns the field name the element belongs to\n    */\n\n    this.get_field_name = this.get_field_name.bind(this);\n    /*\n    Returns the sibling field element with the specified name\n    */\n\n    this.get_sibling = this.get_sibling.bind(this);\n    /*\n    Sets the value for an sibling field with specified base name\n    */\n\n    this.set_sibling_value = this.set_sibling_value.bind(this);\n    /*\n    Formats a date to yyyy-mm-dd\n    */\n\n    this.format_date = this.format_date.bind(this);\n    this.get_subfield = this.get_subfield.bind(this);\n    /*\n    Searches by medical record number. Returns a dict with information about the\n    patient if the mrn is found. Returns nothing otherwise\n    */\n\n    this.search_mrn = this.search_mrn.bind(this);\n    /*\n    Render the content of a Handlebars template in a jQuery UID dialog\n    [1] http://handlebarsjs.com/\n    [2] https://jqueryui.com/dialog/\n    */\n\n    this.template_dialog = this.template_dialog.bind(this);\n    this.render_template = this.render_template.bind(this);\n    /*\n    Ajax Submit with automatic event triggering and some sane defaults\n    */\n\n    this.ajax_submit = this.ajax_submit.bind(this);\n    /*\n    Returns the portal url (calculated in code)\n    */\n\n    this.get_portal_url = this.get_portal_url.bind(this);\n    /*\n    Prints a debug message in console with this component name prefixed\n    */\n\n    this.debug = this.debug.bind(this);\n    console.debug(\"TemporaryIdentifierWidget::load\");\n    this.auto_wildcard = \"-- autogenerated --\";\n    this.is_add_sample_form = document.body.classList.contains(\"template-ar_add\"); // reset all values from identifier widgets that are temporary if current\n    // page is Add Sample form. Maybe the user selected samples from samples\n    // listing and pressed \"Copy to new\", so the widget contains the values from\n    // the original samples being copied, which is wrong\n\n    if (this.is_add_sample_form) {\n      this.reset_values();\n    } // bind the event handler to the elements\n\n\n    this.bind_event_handler();\n    return this;\n  }\n\n  _createClass(TemporaryIdentifierWidgetController, [{\n    key: \"reset_values\",\n    value: function reset_values() {\n      var el, i, j, k, len, len1, len2, ref, ref1, ref2, results, selector;\n      this.debug(\"°°° TemporaryIdentifierWidget::reset_values\"); // value elements (only if temporary is set)\n\n      selector = \".TemporaryIdentifier.temporary-id input[id$='_value']\";\n      ref = document.querySelectorAll(selector);\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        el = ref[i];\n        this.reset_value(el, this.auto_wildcard);\n      }\n\n      selector = \".TemporaryIdentifier.temporary-id input[name*='.value:']\";\n      ref1 = document.querySelectorAll(selector);\n\n      for (j = 0, len1 = ref1.length; j < len1; j++) {\n        el = ref1[j];\n        this.reset_value(el, this.auto_wildcard);\n      } // value_auto elements\n\n\n      selector = \".TemporaryIdentifier input[name*='.value_auto:']\";\n      ref2 = document.querySelectorAll(selector);\n      results = [];\n\n      for (k = 0, len2 = ref2.length; k < len2; k++) {\n        el = ref2[k];\n        results.push(this.reset_value(el));\n      }\n\n      return results;\n    }\n  }, {\n    key: \"reset_value\",\n    value: function reset_value(el) {\n      var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      this.debug(\"\\xB0\\xB0\\xB0 TemporaryIdentifierWidget::reset_value:el=\".concat(el.id || el.name, \",value='\").concat(value, \"'\"));\n      return el.value = value;\n    }\n  }, {\n    key: \"bind_event_handler\",\n    value: function bind_event_handler() {\n      this.debug(\"TemporaryIdentifierWidget::bind_event_handler\");\n      jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"body\").on(\"change\", \".TemporaryIdentifier input[type='checkbox']\", this.on_temporary_change);\n      jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"body\").on(\"change\", \".TemporaryIdentifier input[type='text']\", this.on_value_change);\n      return jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"body\").on(\"keypress\", \".TemporaryIdentifier input[type='text']\", this.on_keypress);\n    }\n  }, {\n    key: \"on_temporary_change\",\n    value: function on_temporary_change(event) {\n      var auto, el, field, input_field, is_temporary;\n      this.debug(\"°°° TemporaryIdentifierWidget::on_temporary_change °°°\");\n      el = event.currentTarget;\n      field = this.get_field_name(el); // Is temporary?\n\n      is_temporary = el.checked; // Update the hidden field that stores whether is temporary or not\n\n      this.set_temporary(field, is_temporary); // Get the value from the hidden field that stores the value autogenerated\n      // by the system for this content in the past, if any. Otherwise, assume this\n      // is either a new content or it was not temporary in the past by assigning\n      // the wildcard \"-- autogenerated --\"\n\n      auto = this.get_autogenerated_id(field, this.auto_wildcard); // Disable/enable the input field for manual introduction of value\n\n      input_field = this.get_input_element(field);\n      input_field.disabled = is_temporary;\n\n      if (is_temporary && !input_field.value) {\n        // Update the value with autogenerated, but only if empty\n        input_field.value = auto;\n        return jquery__WEBPACK_IMPORTED_MODULE_0___default()(input_field).trigger(\"change\");\n      } else if (!is_temporary && input_field.value === auto) {\n        // Clear the value, but only if autogenerated\n        input_field.value = \"\";\n        return jquery__WEBPACK_IMPORTED_MODULE_0___default()(input_field).trigger(\"change\");\n      }\n    }\n  }, {\n    key: \"on_value_change\",\n    value: function on_value_change(event) {\n      var catalog_name, current_value, el, field;\n      this.debug(\"°°° TemporaryIdentifierWidget::on_value_change °°°\");\n      el = event.currentTarget;\n      field = this.get_field_name(el); // Get the current value\n\n      current_value = this.get_current_id(field); // Update the hidden field that stores the id\n\n      this.set_current_id(field, el.value); // Do not continue unless the value is non-empty\n\n      if (!(el.value && el.value !== this.auto_wildcard)) {\n        return;\n      } // Grab the catalog name to search against\n\n\n      catalog_name = this.get_sibling(el, \"config_catalog\").value; // Search for an existing MRN\n\n      return this.search_mrn(el.value, catalog_name).done(function (data) {\n        var address, buttons, dialog, me, record, template_id;\n\n        if (!data) {\n          return;\n        } // Address blocks\n\n\n        address = [data.address, data.zipcode, data.city, data.country].filter(function (value) {\n          return value;\n        }); // map patient fields -> Sample fields\n\n        record = {\n          \"PatientFullName\": data.Title,\n          \"PatientAddress\": address.join(\", \"),\n          \"DateOfBirth\": this.format_date(data.birthdate),\n          \"Age\": data.age,\n          \"Gender\": data.gender,\n          \"review_state\": data.review_state\n        }; // Template dialog to render depending if active or not\n\n        template_id = \"existing-identifier\";\n        buttons = null;\n\n        if (data.review_state === \"inactive\") {\n          template_id = \"inactive-patient\";\n          buttons = {};\n\n          buttons[_t(\"Close\")] = function () {\n            // trigger 'no' event\n            jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).trigger(\"no\");\n            return jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).dialog(\"close\");\n          };\n        } // Render the popup dialog\n\n\n        me = this;\n\n        if (data.identifier == null) {\n          data.identifier = el.value;\n        }\n\n        dialog = this.template_dialog(template_id, data, buttons);\n        dialog.on(\"yes\", function () {\n          var results, value; // Update field values from the whole form\n\n          results = [];\n\n          for (field in record) {\n            value = record[field];\n            results.push(me.set_sibling_value(el, field, value));\n          }\n\n          return results;\n        });\n        return dialog.on(\"no\", function () {\n          // Restore the value and do nothing else\n          el.value = current_value;\n          return me.set_current_id(field, current_value);\n        });\n      });\n    }\n  }, {\n    key: \"on_keypress\",\n    value: function on_keypress(event) {\n      var el;\n\n      if (event.keyCode === 13) {\n        el = event.currentTarget;\n        jquery__WEBPACK_IMPORTED_MODULE_0___default()(el).trigger(\"blur\");\n        return event.preventDefault();\n      }\n    }\n  }, {\n    key: \"set_temporary\",\n    value: function set_temporary(field, is_temporary) {\n      return this.get_subfield(field, \"temporary\").value = is_temporary || \"\";\n    }\n  }, {\n    key: \"set_current_id\",\n    value: function set_current_id(field, value) {\n      return this.get_subfield(field, \"value\").value = value;\n    }\n  }, {\n    key: \"get_current_id\",\n    value: function get_current_id(field) {\n      var default_value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      return this.get_subfield(field, \"value\").value || default_value;\n    }\n  }, {\n    key: \"get_autogenerated_id\",\n    value: function get_autogenerated_id(field) {\n      var default_value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      return this.get_subfield(field, \"value_auto\").value || default_value;\n    }\n  }, {\n    key: \"get_input_element\",\n    value: function get_input_element(field) {\n      return document.querySelector(\"#\".concat(field, \"_value\"));\n    }\n  }, {\n    key: \"get_field_name\",\n    value: function get_field_name(element) {\n      var parent;\n      parent = element.closest(\"div[data-fieldname]\");\n      return jquery__WEBPACK_IMPORTED_MODULE_0___default()(parent).attr(\"data-fieldname\");\n    }\n  }, {\n    key: \"get_sibling\",\n    value: function get_sibling(element, name) {\n      var field;\n      field = name;\n      return document.querySelector('[name=\"' + field + '\"]');\n    }\n  }, {\n    key: \"set_sibling_value\",\n    value: function set_sibling_value(element, name, value) {\n      var field;\n      this.debug(\"\\xB0\\xB0\\xB0 TemporaryIdentifierWidget::set_sibling_value:name=\".concat(name, \",value=\").concat(value, \" \\xB0\\xB0\\xB0\"));\n      field = this.get_sibling(element, name);\n\n      if (!field) {\n        return;\n      }\n\n      this.debug(\">>> \".concat(field.name, \" = \").concat(value, \" \"));\n      return field.value = value;\n    }\n  }, {\n    key: \"format_date\",\n    value: function format_date(date_value) {\n      var d, out;\n\n      if (date_value == null) {\n        return \"\";\n      }\n\n      d = new Date(date_value);\n      out = [d.getFullYear(), ('0' + (d.getMonth() + 1)).slice(-2), ('0' + d.getDate()).slice(-2)];\n      return out.join('-');\n    }\n  }, {\n    key: \"get_subfield\",\n    value: function get_subfield(field, subfield) {\n      return document.querySelector('input[name^=\"' + field + '.' + subfield + ':\"]');\n    }\n  }, {\n    key: \"search_mrn\",\n    value: function search_mrn(mrn, catalog_name) {\n      var deferred, fields, options;\n      this.debug(\"\\xB0\\xB0\\xB0 TemporaryIdentifierWidget::search_mrn:mrn=\".concat(mrn, \" \\xB0\\xB0\\xB0\")); // Fields to include on search results\n\n      fields = [\"Title\", \"name\", \"surname\", \"age\", \"birthdate\", \"gender\", \"email\", \"address\", \"zipcode\", \"city\", \"country\", \"review_state\"];\n      deferred = jquery__WEBPACK_IMPORTED_MODULE_0___default.a.Deferred();\n      options = {\n        url: this.get_portal_url() + \"/@@API/read\",\n        data: {\n          portal_type: \"Patient\",\n          catalog_name: catalog_name,\n          patient_mrn: mrn,\n          include_fields: fields,\n          page_size: 1\n        }\n      };\n      this.ajax_submit(options).done(function (data) {\n        var object;\n        object = {};\n\n        if (data.objects) {\n          // resolve with the first item of the list\n          object = data.objects[0];\n        }\n\n        return deferred.resolveWith(this, [object]);\n      });\n      return deferred.promise();\n    }\n  }, {\n    key: \"template_dialog\",\n    value: function template_dialog(template_id, context, buttons) {\n      var content; // prepare the buttons\n\n      if (buttons == null) {\n        buttons = {};\n\n        buttons[_t(\"Yes\")] = function () {\n          // trigger 'yes' event\n          jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).trigger(\"yes\");\n          return jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).dialog(\"close\");\n        };\n\n        buttons[_t(\"No\")] = function () {\n          // trigger 'no' event\n          jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).trigger(\"no\");\n          return jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).dialog(\"close\");\n        };\n      } // render the Handlebars template\n\n\n      content = this.render_template(template_id, context); // render the dialog box\n\n      return jquery__WEBPACK_IMPORTED_MODULE_0___default()(content).dialog({\n        width: 450,\n        resizable: false,\n        closeOnEscape: false,\n        buttons: buttons,\n        open: function open(event, ui) {\n          // Hide the X button on the top right border\n          return jquery__WEBPACK_IMPORTED_MODULE_0___default()(\".ui-dialog-titlebar-close\").hide();\n        }\n      });\n    }\n  }, {\n    key: \"render_template\",\n    value: function render_template(template_id, context) {\n      var source, template;\n      /*\n       * Render Handlebars JS template\n       */\n\n      this.debug(\"\\xB0\\xB0\\xB0 TemporaryIdentifierWidget::render_template:template_id:\".concat(template_id, \" \\xB0\\xB0\\xB0\")); // get the template by ID\n\n      source = jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"#\".concat(template_id)).html();\n\n      if (!source) {\n        return;\n      } // Compile the handlebars template\n\n\n      template = Handlebars.compile(source); // Render the template with the given context\n\n      return template(context);\n    }\n  }, {\n    key: \"ajax_submit\",\n    value: function ajax_submit() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var done;\n      this.debug(\"°°° TemporaryIdentifierWidget::ajax_submit °°°\"); // some sane option defaults\n\n      if (options.type == null) {\n        options.type = \"POST\";\n      }\n\n      if (options.url == null) {\n        options.url = this.get_portal_url();\n      }\n\n      if (options.context == null) {\n        options.context = this;\n      }\n\n      if (options.dataType == null) {\n        options.dataType = \"json\";\n      }\n\n      if (options.data == null) {\n        options.data = {};\n      }\n\n      if (options._authenticator == null) {\n        options._authenticator = jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"input[name='_authenticator']\").val();\n      }\n\n      console.debug(\">>> ajax_submit::options=\", options);\n      jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).trigger(\"ajax:submit:start\");\n\n      done = function done() {\n        return jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).trigger(\"ajax:submit:end\");\n      };\n\n      return jquery__WEBPACK_IMPORTED_MODULE_0___default.a.ajax(options).done(done);\n    }\n  }, {\n    key: \"get_portal_url\",\n    value: function get_portal_url() {\n      var url;\n      url = jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"input[name=portal_url]\").val();\n      return url || window.portal_url;\n    }\n  }, {\n    key: \"debug\",\n    value: function debug(message) {\n      return console.debug(\"[senaite.patient.temporary_identifier_widget] \", message);\n    }\n  }]);\n\n  return TemporaryIdentifierWidgetController;\n}();\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (TemporaryIdentifierWidgetController);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21wb25lbnRzL3RlbXBvcmFyeWlkZW50aWZpZXJ3aWRnZXQuY29mZmVlLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy90ZW1wb3JhcnlpZGVudGlmaWVyd2lkZ2V0LmNvZmZlZT8yYzZkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAkIGZyb20gXCJqcXVlcnlcIlxuXG5cbmNsYXNzIFRlbXBvcmFyeUlkZW50aWZpZXJXaWRnZXRDb250cm9sbGVyXG5cbiAgY29uc3RydWN0b3I6IC0+XG4gICAgY29uc29sZS5kZWJ1ZyBcIlRlbXBvcmFyeUlkZW50aWZpZXJXaWRnZXQ6OmxvYWRcIlxuXG4gICAgQGF1dG9fd2lsZGNhcmQgPSBcIi0tIGF1dG9nZW5lcmF0ZWQgLS1cIlxuICAgIEBpc19hZGRfc2FtcGxlX2Zvcm0gPSBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucyBcInRlbXBsYXRlLWFyX2FkZFwiXG5cbiAgICAjIHJlc2V0IGFsbCB2YWx1ZXMgZnJvbSBpZGVudGlmaWVyIHdpZGdldHMgdGhhdCBhcmUgdGVtcG9yYXJ5IGlmIGN1cnJlbnRcbiAgICAjIHBhZ2UgaXMgQWRkIFNhbXBsZSBmb3JtLiBNYXliZSB0aGUgdXNlciBzZWxlY3RlZCBzYW1wbGVzIGZyb20gc2FtcGxlc1xuICAgICMgbGlzdGluZyBhbmQgcHJlc3NlZCBcIkNvcHkgdG8gbmV3XCIsIHNvIHRoZSB3aWRnZXQgY29udGFpbnMgdGhlIHZhbHVlcyBmcm9tXG4gICAgIyB0aGUgb3JpZ2luYWwgc2FtcGxlcyBiZWluZyBjb3BpZWQsIHdoaWNoIGlzIHdyb25nXG4gICAgaWYgQGlzX2FkZF9zYW1wbGVfZm9ybVxuICAgICAgQHJlc2V0X3ZhbHVlcygpXG5cbiAgICAjIGJpbmQgdGhlIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGVsZW1lbnRzXG4gICAgQGJpbmRfZXZlbnRfaGFuZGxlcigpXG4gICAgcmV0dXJuIEBcblxuICAjIyNcbiAgUmVzZXQgdmFsdWVfYXV0byBmcm9tIGFsbCBpZGVudGlmaWVyIHdpZGdldHMgYW5kIHZhbHVlIGZyb20gaWRlbnRpZmllciB3aWRnZXRzXG4gIHRoYXQgYXJlIHRlbXBvcmFyeVxuICAjIyNcbiAgcmVzZXRfdmFsdWVzOiA9PlxuICAgIEBkZWJ1ZyBcIsKwwrDCsCBUZW1wb3JhcnlJZGVudGlmaWVyV2lkZ2V0OjpyZXNldF92YWx1ZXNcIlxuXG4gICAgIyB2YWx1ZSBlbGVtZW50cyAob25seSBpZiB0ZW1wb3JhcnkgaXMgc2V0KVxuICAgIHNlbGVjdG9yID0gXCIuVGVtcG9yYXJ5SWRlbnRpZmllci50ZW1wb3JhcnktaWQgaW5wdXRbaWQkPSdfdmFsdWUnXVwiXG4gICAgQHJlc2V0X3ZhbHVlIGVsLCBAYXV0b193aWxkY2FyZCBmb3IgZWwgaW4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcilcblxuICAgIHNlbGVjdG9yID0gXCIuVGVtcG9yYXJ5SWRlbnRpZmllci50ZW1wb3JhcnktaWQgaW5wdXRbbmFtZSo9Jy52YWx1ZTonXVwiXG4gICAgQHJlc2V0X3ZhbHVlIGVsLCBAYXV0b193aWxkY2FyZCBmb3IgZWwgaW4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcilcblxuICAgICMgdmFsdWVfYXV0byBlbGVtZW50c1xuICAgIHNlbGVjdG9yID0gXCIuVGVtcG9yYXJ5SWRlbnRpZmllciBpbnB1dFtuYW1lKj0nLnZhbHVlX2F1dG86J11cIlxuICAgIEByZXNldF92YWx1ZSBlbCBmb3IgZWwgaW4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcilcblxuICAjIyNcbiAgUmVzZXQgdGhlIHZhbHVlIGZvciB0aGUgZ2l2ZW4gZWxlbWVudFxuICAjIyNcbiAgcmVzZXRfdmFsdWU6IChlbCwgdmFsdWU9XCJcIikgPT5cbiAgICBAZGVidWcgXCLCsMKwwrAgVGVtcG9yYXJ5SWRlbnRpZmllcldpZGdldDo6cmVzZXRfdmFsdWU6ZWw9I3sgZWwuaWQgb3IgZWwubmFtZSB9LHZhbHVlPScjeyB2YWx1ZSB9J1wiXG4gICAgZWwudmFsdWUgPSB2YWx1ZVxuXG4gIGJpbmRfZXZlbnRfaGFuZGxlcjogPT5cbiAgICBAZGVidWcgXCJUZW1wb3JhcnlJZGVudGlmaWVyV2lkZ2V0OjpiaW5kX2V2ZW50X2hhbmRsZXJcIlxuICAgICQoXCJib2R5XCIpLm9uIFwiY2hhbmdlXCIsIFwiLlRlbXBvcmFyeUlkZW50aWZpZXIgaW5wdXRbdHlwZT0nY2hlY2tib3gnXVwiLCBAb25fdGVtcG9yYXJ5X2NoYW5nZVxuICAgICQoXCJib2R5XCIpLm9uIFwiY2hhbmdlXCIsIFwiLlRlbXBvcmFyeUlkZW50aWZpZXIgaW5wdXRbdHlwZT0ndGV4dCddXCIsIEBvbl92YWx1ZV9jaGFuZ2VcbiAgICAkKFwiYm9keVwiKS5vbiBcImtleXByZXNzXCIsIFwiLlRlbXBvcmFyeUlkZW50aWZpZXIgaW5wdXRbdHlwZT0ndGV4dCddXCIsIEBvbl9rZXlwcmVzc1xuXG4gICMjI1xuICBFdmVudCBoYW5kbGVyIGZvciBUZW1wb3JhcnlJZGVudGlmaWVyJ3MgY2hlY2tib3ggY2hhbmdlXG4gICMjI1xuICBvbl90ZW1wb3JhcnlfY2hhbmdlOiAoZXZlbnQpID0+XG4gICAgQGRlYnVnIFwiwrDCsMKwIFRlbXBvcmFyeUlkZW50aWZpZXJXaWRnZXQ6Om9uX3RlbXBvcmFyeV9jaGFuZ2UgwrDCsMKwXCJcblxuICAgIGVsID0gZXZlbnQuY3VycmVudFRhcmdldFxuICAgIGZpZWxkID0gQGdldF9maWVsZF9uYW1lIGVsXG5cbiAgICAjIElzIHRlbXBvcmFyeT9cbiAgICBpc190ZW1wb3JhcnkgPSBlbC5jaGVja2VkXG5cbiAgICAjIFVwZGF0ZSB0aGUgaGlkZGVuIGZpZWxkIHRoYXQgc3RvcmVzIHdoZXRoZXIgaXMgdGVtcG9yYXJ5IG9yIG5vdFxuICAgIEBzZXRfdGVtcG9yYXJ5IGZpZWxkLCBpc190ZW1wb3JhcnlcblxuICAgICMgR2V0IHRoZSB2YWx1ZSBmcm9tIHRoZSBoaWRkZW4gZmllbGQgdGhhdCBzdG9yZXMgdGhlIHZhbHVlIGF1dG9nZW5lcmF0ZWRcbiAgICAjIGJ5IHRoZSBzeXN0ZW0gZm9yIHRoaXMgY29udGVudCBpbiB0aGUgcGFzdCwgaWYgYW55LiBPdGhlcndpc2UsIGFzc3VtZSB0aGlzXG4gICAgIyBpcyBlaXRoZXIgYSBuZXcgY29udGVudCBvciBpdCB3YXMgbm90IHRlbXBvcmFyeSBpbiB0aGUgcGFzdCBieSBhc3NpZ25pbmdcbiAgICAjIHRoZSB3aWxkY2FyZCBcIi0tIGF1dG9nZW5lcmF0ZWQgLS1cIlxuICAgIGF1dG8gPSBAZ2V0X2F1dG9nZW5lcmF0ZWRfaWQgZmllbGQsIEBhdXRvX3dpbGRjYXJkXG5cbiAgICAjIERpc2FibGUvZW5hYmxlIHRoZSBpbnB1dCBmaWVsZCBmb3IgbWFudWFsIGludHJvZHVjdGlvbiBvZiB2YWx1ZVxuICAgIGlucHV0X2ZpZWxkID0gQGdldF9pbnB1dF9lbGVtZW50IGZpZWxkXG4gICAgaW5wdXRfZmllbGQuZGlzYWJsZWQgPSBpc190ZW1wb3JhcnlcblxuICAgIGlmIGlzX3RlbXBvcmFyeSBhbmQgbm90IGlucHV0X2ZpZWxkLnZhbHVlXG4gICAgICAjIFVwZGF0ZSB0aGUgdmFsdWUgd2l0aCBhdXRvZ2VuZXJhdGVkLCBidXQgb25seSBpZiBlbXB0eVxuICAgICAgaW5wdXRfZmllbGQudmFsdWUgPSBhdXRvXG4gICAgICAkKGlucHV0X2ZpZWxkKS50cmlnZ2VyIFwiY2hhbmdlXCJcblxuICAgIGVsc2UgaWYgbm90IGlzX3RlbXBvcmFyeSBhbmQgaW5wdXRfZmllbGQudmFsdWUgPT0gYXV0b1xuICAgICAgIyBDbGVhciB0aGUgdmFsdWUsIGJ1dCBvbmx5IGlmIGF1dG9nZW5lcmF0ZWRcbiAgICAgIGlucHV0X2ZpZWxkLnZhbHVlID0gXCJcIlxuICAgICAgJChpbnB1dF9maWVsZCkudHJpZ2dlciBcImNoYW5nZVwiXG5cbiAgIyMjXG4gIEV2ZW50IGhhbmRsZXIgZm9yIFRlbXBvcmFyeUlkZW50aWZpZXIncyB2YWx1ZSBjaGFuZ2VcbiAgIyMjXG4gIG9uX3ZhbHVlX2NoYW5nZTogKGV2ZW50KSA9PlxuICAgIEBkZWJ1ZyBcIsKwwrDCsCBUZW1wb3JhcnlJZGVudGlmaWVyV2lkZ2V0Ojpvbl92YWx1ZV9jaGFuZ2UgwrDCsMKwXCJcblxuICAgIGVsID0gZXZlbnQuY3VycmVudFRhcmdldFxuICAgIGZpZWxkID0gQGdldF9maWVsZF9uYW1lIGVsXG5cbiAgICAjIEdldCB0aGUgY3VycmVudCB2YWx1ZVxuICAgIGN1cnJlbnRfdmFsdWUgPSAgQGdldF9jdXJyZW50X2lkIGZpZWxkXG5cbiAgICAjIFVwZGF0ZSB0aGUgaGlkZGVuIGZpZWxkIHRoYXQgc3RvcmVzIHRoZSBpZFxuICAgIEBzZXRfY3VycmVudF9pZCBmaWVsZCwgZWwudmFsdWVcblxuICAgICMgRG8gbm90IGNvbnRpbnVlIHVubGVzcyB0aGUgdmFsdWUgaXMgbm9uLWVtcHR5XG4gICAgcmV0dXJuIHVubGVzcyBlbC52YWx1ZSBhbmQgZWwudmFsdWUgIT0gQGF1dG9fd2lsZGNhcmRcblxuICAgICMgR3JhYiB0aGUgY2F0YWxvZyBuYW1lIHRvIHNlYXJjaCBhZ2FpbnN0XG4gICAgY2F0YWxvZ19uYW1lID0gQGdldF9zaWJsaW5nKGVsLCBcImNvbmZpZ19jYXRhbG9nXCIpLnZhbHVlXG5cbiAgICAjIFNlYXJjaCBmb3IgYW4gZXhpc3RpbmcgTVJOXG4gICAgQHNlYXJjaF9tcm4gZWwudmFsdWUsIGNhdGFsb2dfbmFtZVxuICAgIC5kb25lIChkYXRhKSAtPlxuICAgICAgcmV0dXJuIHVubGVzcyBkYXRhXG5cbiAgICAgICMgQWRkcmVzcyBibG9ja3NcbiAgICAgIGFkZHJlc3MgPSBbXG4gICAgICAgIGRhdGEuYWRkcmVzcyxcbiAgICAgICAgZGF0YS56aXBjb2RlLFxuICAgICAgICBkYXRhLmNpdHksXG4gICAgICAgIGRhdGEuY291bnRyeVxuICAgICAgXS5maWx0ZXIoKHZhbHVlKSAtPiB2YWx1ZSlcblxuICAgICAgIyBtYXAgcGF0aWVudCBmaWVsZHMgLT4gU2FtcGxlIGZpZWxkc1xuICAgICAgcmVjb3JkID0ge1xuICAgICAgICBcIlBhdGllbnRGdWxsTmFtZVwiOiBkYXRhLlRpdGxlLFxuICAgICAgICBcIlBhdGllbnRBZGRyZXNzXCI6IGFkZHJlc3Muam9pbihcIiwgXCIpLFxuICAgICAgICBcIkRhdGVPZkJpcnRoXCI6IEBmb3JtYXRfZGF0ZShkYXRhLmJpcnRoZGF0ZSksXG4gICAgICAgIFwiQWdlXCI6IGRhdGEuYWdlLFxuICAgICAgICBcIkdlbmRlclwiOiBkYXRhLmdlbmRlcixcbiAgICAgICAgXCJyZXZpZXdfc3RhdGVcIjogZGF0YS5yZXZpZXdfc3RhdGUsXG4gICAgICB9XG5cbiAgICAgICMgVGVtcGxhdGUgZGlhbG9nIHRvIHJlbmRlciBkZXBlbmRpbmcgaWYgYWN0aXZlIG9yIG5vdFxuICAgICAgdGVtcGxhdGVfaWQgPSBcImV4aXN0aW5nLWlkZW50aWZpZXJcIlxuICAgICAgYnV0dG9ucyA9IG51bGxcbiAgICAgIGlmIGRhdGEucmV2aWV3X3N0YXRlID09IFwiaW5hY3RpdmVcIlxuICAgICAgICB0ZW1wbGF0ZV9pZCA9IFwiaW5hY3RpdmUtcGF0aWVudFwiXG4gICAgICAgIGJ1dHRvbnMgPSB7fVxuICAgICAgICBidXR0b25zW190KFwiQ2xvc2VcIildID0gLT5cbiAgICAgICAgICAjIHRyaWdnZXIgJ25vJyBldmVudFxuICAgICAgICAgICQoQCkudHJpZ2dlciBcIm5vXCJcbiAgICAgICAgICAkKEApLmRpYWxvZyBcImNsb3NlXCJcblxuICAgICAgIyBSZW5kZXIgdGhlIHBvcHVwIGRpYWxvZ1xuICAgICAgbWUgPSBAXG4gICAgICBkYXRhLmlkZW50aWZpZXIgPz0gZWwudmFsdWVcbiAgICAgIGRpYWxvZyA9IEB0ZW1wbGF0ZV9kaWFsb2cgdGVtcGxhdGVfaWQsIGRhdGEsIGJ1dHRvbnNcbiAgICAgIGRpYWxvZy5vbiBcInllc1wiLCAtPlxuICAgICAgICAjIFVwZGF0ZSBmaWVsZCB2YWx1ZXMgZnJvbSB0aGUgd2hvbGUgZm9ybVxuICAgICAgICBmb3IgZmllbGQsIHZhbHVlIG9mIHJlY29yZFxuICAgICAgICAgIG1lLnNldF9zaWJsaW5nX3ZhbHVlIGVsLCBmaWVsZCwgdmFsdWVcblxuICAgICAgZGlhbG9nLm9uIFwibm9cIiwgLT5cbiAgICAgICAgIyBSZXN0b3JlIHRoZSB2YWx1ZSBhbmQgZG8gbm90aGluZyBlbHNlXG4gICAgICAgIGVsLnZhbHVlID0gY3VycmVudF92YWx1ZVxuICAgICAgICBtZS5zZXRfY3VycmVudF9pZCBmaWVsZCwgY3VycmVudF92YWx1ZVxuXG4gICMjI1xuICBFdmVudCBoYW5kbGVyIGZvciBUZW1wb3JhcnlJZGVudGlmaWVyJ3MgdmFsdWUgY2hhbmdlXG4gICMjI1xuICBvbl9rZXlwcmVzczogKGV2ZW50KSA9PlxuICAgIGlmIGV2ZW50LmtleUNvZGUgPT0gMTNcbiAgICAgIGVsID0gZXZlbnQuY3VycmVudFRhcmdldFxuICAgICAgJChlbCkudHJpZ2dlcihcImJsdXJcIilcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcblxuICAjIyNcbiAgU2V0cyB0aGUgdGVtcG9yYXJ5IHZhbHVlIG9mIHRlIGZpZWxkXG4gICMjI1xuICBzZXRfdGVtcG9yYXJ5OiAoZmllbGQsIGlzX3RlbXBvcmFyeSkgPT5cbiAgICBAZ2V0X3N1YmZpZWxkKGZpZWxkLCBcInRlbXBvcmFyeVwiKS52YWx1ZSA9IGlzX3RlbXBvcmFyeSBvciBcIlwiXG5cbiAgIyMjXG4gIFNldHMgdGhlIGN1cnJlbnQgaWQgdmFsdWUgb2YgdGhlIGZpZWxkXG4gICMjI1xuICBzZXRfY3VycmVudF9pZDogKGZpZWxkLCB2YWx1ZSkgPT5cbiAgICBAZ2V0X3N1YmZpZWxkKGZpZWxkLCBcInZhbHVlXCIpLnZhbHVlID0gdmFsdWVcblxuICAjIyNcbiAgUmV0dXJucyB0aGUgY3VycmVudCBpZCB2YWx1ZSBvZiB0aGUgZmllbGRcbiAgIyMjXG4gIGdldF9jdXJyZW50X2lkOiAoZmllbGQsIGRlZmF1bHRfdmFsdWU9XCJcIikgPT5cbiAgICBAZ2V0X3N1YmZpZWxkKGZpZWxkLCBcInZhbHVlXCIpLnZhbHVlIG9yIGRlZmF1bHRfdmFsdWVcblxuICAjIyNcbiAgUmV0dXJucyB0aGUgaWQgdmFsdWUgdGhhdCBpcy93YXMgYXV0by1nZW5lcmF0ZWQgZm9yIHRoZSBmaWVsZFxuICAjIyNcbiAgZ2V0X2F1dG9nZW5lcmF0ZWRfaWQ6IChmaWVsZCwgZGVmYXVsdF92YWx1ZT1cIlwiKSA9PlxuICAgIEBnZXRfc3ViZmllbGQoZmllbGQsIFwidmFsdWVfYXV0b1wiKS52YWx1ZSBvciBkZWZhdWx0X3ZhbHVlXG5cbiAgIyMjXG4gIFJldHVybnMgdGhlIGlucHV0IGVsZW1lbnQgZm9yIG1hbnVhbCBpbnRyb2R1Y3Rpb24gb2YgYW4gaWRlbnRpZmllciB2YWx1ZVxuICAjIyNcbiAgZ2V0X2lucHV0X2VsZW1lbnQ6IChmaWVsZCkgPT5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiIyN7IGZpZWxkIH1fdmFsdWVcIilcblxuICAjIyNcbiAgUmV0dXJucyB0aGUgZmllbGQgbmFtZSB0aGUgZWxlbWVudCBiZWxvbmdzIHRvXG4gICMjI1xuICBnZXRfZmllbGRfbmFtZTogKGVsZW1lbnQpID0+XG4gICAgcGFyZW50ID0gZWxlbWVudC5jbG9zZXN0KFwiZGl2W2RhdGEtZmllbGRuYW1lXVwiKVxuICAgICQocGFyZW50KS5hdHRyIFwiZGF0YS1maWVsZG5hbWVcIlxuXG4gICMjI1xuICBSZXR1cm5zIHRoZSBzaWJsaW5nIGZpZWxkIGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWVcbiAgIyMjXG4gIGdldF9zaWJsaW5nOiAoZWxlbWVudCwgbmFtZSkgPT5cbiAgICBmaWVsZCA9IG5hbWVcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbbmFtZT1cIicrZmllbGQrJ1wiXScpXG5cbiAgIyMjXG4gIFNldHMgdGhlIHZhbHVlIGZvciBhbiBzaWJsaW5nIGZpZWxkIHdpdGggc3BlY2lmaWVkIGJhc2UgbmFtZVxuICAjIyNcbiAgc2V0X3NpYmxpbmdfdmFsdWU6IChlbGVtZW50LCBuYW1lLCB2YWx1ZSkgPT5cbiAgICBAZGVidWcgXCLCsMKwwrAgVGVtcG9yYXJ5SWRlbnRpZmllcldpZGdldDo6c2V0X3NpYmxpbmdfdmFsdWU6bmFtZT0jeyBuYW1lIH0sdmFsdWU9I3sgdmFsdWUgfSDCsMKwwrBcIlxuICAgIGZpZWxkID0gQGdldF9zaWJsaW5nIGVsZW1lbnQsIG5hbWVcbiAgICByZXR1cm4gdW5sZXNzIGZpZWxkXG4gICAgQGRlYnVnIFwiPj4+ICN7IGZpZWxkLm5hbWUgfSA9ICN7IHZhbHVlIH0gXCJcbiAgICBmaWVsZC52YWx1ZSA9IHZhbHVlXG5cbiAgIyMjXG4gIEZvcm1hdHMgYSBkYXRlIHRvIHl5eXktbW0tZGRcbiAgIyMjXG4gIGZvcm1hdF9kYXRlOiAoZGF0ZV92YWx1ZSkgPT5cbiAgICBpZiBub3QgZGF0ZV92YWx1ZT9cbiAgICAgIHJldHVybiBcIlwiXG4gICAgZCA9IG5ldyBEYXRlKGRhdGVfdmFsdWUpXG4gICAgb3V0ID0gW1xuICAgICAgZC5nZXRGdWxsWWVhcigpLFxuICAgICAgKCcwJyArIChkLmdldE1vbnRoKCkgKyAxKSkuc2xpY2UoLTIpLFxuICAgICAgKCcwJyArIGQuZ2V0RGF0ZSgpKS5zbGljZSgtMiksXG4gICAgXVxuICAgIG91dC5qb2luKCctJylcblxuICBnZXRfc3ViZmllbGQ6IChmaWVsZCwgc3ViZmllbGQpID0+XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvciAnaW5wdXRbbmFtZV49XCInK2ZpZWxkKycuJytzdWJmaWVsZCsnOlwiXSdcblxuICAjIyNcbiAgU2VhcmNoZXMgYnkgbWVkaWNhbCByZWNvcmQgbnVtYmVyLiBSZXR1cm5zIGEgZGljdCB3aXRoIGluZm9ybWF0aW9uIGFib3V0IHRoZVxuICBwYXRpZW50IGlmIHRoZSBtcm4gaXMgZm91bmQuIFJldHVybnMgbm90aGluZyBvdGhlcndpc2VcbiAgIyMjXG4gIHNlYXJjaF9tcm46IChtcm4sIGNhdGFsb2dfbmFtZSkgPT5cbiAgICBAZGVidWcgXCLCsMKwwrAgVGVtcG9yYXJ5SWRlbnRpZmllcldpZGdldDo6c2VhcmNoX21ybjptcm49I3sgbXJuIH0gwrDCsMKwXCJcblxuICAgICMgRmllbGRzIHRvIGluY2x1ZGUgb24gc2VhcmNoIHJlc3VsdHNcbiAgICBmaWVsZHMgPSBbXG4gICAgICBcIlRpdGxlXCJcbiAgICAgIFwibmFtZVwiXG4gICAgICBcInN1cm5hbWVcIlxuICAgICAgXCJhZ2VcIlxuICAgICAgXCJiaXJ0aGRhdGVcIlxuICAgICAgXCJnZW5kZXJcIlxuICAgICAgXCJlbWFpbFwiXG4gICAgICBcImFkZHJlc3NcIlxuICAgICAgXCJ6aXBjb2RlXCJcbiAgICAgIFwiY2l0eVwiXG4gICAgICBcImNvdW50cnlcIlxuICAgICAgXCJyZXZpZXdfc3RhdGVcIlxuICAgIF1cblxuICAgIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpXG4gICAgb3B0aW9ucyA9XG4gICAgICB1cmw6IEBnZXRfcG9ydGFsX3VybCgpICsgXCIvQEBBUEkvcmVhZFwiXG4gICAgICBkYXRhOlxuICAgICAgICBwb3J0YWxfdHlwZTogXCJQYXRpZW50XCJcbiAgICAgICAgY2F0YWxvZ19uYW1lOiBjYXRhbG9nX25hbWVcbiAgICAgICAgcGF0aWVudF9tcm46IG1yblxuICAgICAgICBpbmNsdWRlX2ZpZWxkczogZmllbGRzXG4gICAgICAgIHBhZ2Vfc2l6ZTogMVxuXG4gICAgQGFqYXhfc3VibWl0IG9wdGlvbnNcbiAgICAuZG9uZSAoZGF0YSkgLT5cbiAgICAgIG9iamVjdCA9IHt9XG4gICAgICBpZiBkYXRhLm9iamVjdHNcbiAgICAgICAgIyByZXNvbHZlIHdpdGggdGhlIGZpcnN0IGl0ZW0gb2YgdGhlIGxpc3RcbiAgICAgICAgb2JqZWN0ID0gZGF0YS5vYmplY3RzWzBdXG4gICAgICByZXR1cm4gZGVmZXJyZWQucmVzb2x2ZVdpdGggdGhpcywgW29iamVjdF1cblxuICAgIGRlZmVycmVkLnByb21pc2UoKVxuXG4gICMjI1xuICBSZW5kZXIgdGhlIGNvbnRlbnQgb2YgYSBIYW5kbGViYXJzIHRlbXBsYXRlIGluIGEgalF1ZXJ5IFVJRCBkaWFsb2dcbiAgWzFdIGh0dHA6Ly9oYW5kbGViYXJzanMuY29tL1xuICBbMl0gaHR0cHM6Ly9qcXVlcnl1aS5jb20vZGlhbG9nL1xuICAjIyNcbiAgdGVtcGxhdGVfZGlhbG9nOiAodGVtcGxhdGVfaWQsIGNvbnRleHQsIGJ1dHRvbnMpID0+XG4gICAgIyBwcmVwYXJlIHRoZSBidXR0b25zXG4gICAgaWYgbm90IGJ1dHRvbnM/XG4gICAgICBidXR0b25zID0ge31cbiAgICAgIGJ1dHRvbnNbX3QoXCJZZXNcIildID0gLT5cbiAgICAgICAgIyB0cmlnZ2VyICd5ZXMnIGV2ZW50XG4gICAgICAgICQoQCkudHJpZ2dlciBcInllc1wiXG4gICAgICAgICQoQCkuZGlhbG9nIFwiY2xvc2VcIlxuICAgICAgYnV0dG9uc1tfdChcIk5vXCIpXSA9IC0+XG4gICAgICAgICMgdHJpZ2dlciAnbm8nIGV2ZW50XG4gICAgICAgICQoQCkudHJpZ2dlciBcIm5vXCJcbiAgICAgICAgJChAKS5kaWFsb2cgXCJjbG9zZVwiXG5cbiAgICAjIHJlbmRlciB0aGUgSGFuZGxlYmFycyB0ZW1wbGF0ZVxuICAgIGNvbnRlbnQgPSBAcmVuZGVyX3RlbXBsYXRlIHRlbXBsYXRlX2lkLCBjb250ZXh0XG5cbiAgICAjIHJlbmRlciB0aGUgZGlhbG9nIGJveFxuICAgICQoY29udGVudCkuZGlhbG9nXG4gICAgICB3aWR0aDogNDUwXG4gICAgICByZXNpemFibGU6IG5vXG4gICAgICBjbG9zZU9uRXNjYXBlOiBub1xuICAgICAgYnV0dG9uczogYnV0dG9uc1xuICAgICAgb3BlbjogKGV2ZW50LCB1aSkgLT5cbiAgICAgICAgIyBIaWRlIHRoZSBYIGJ1dHRvbiBvbiB0aGUgdG9wIHJpZ2h0IGJvcmRlclxuICAgICAgICAkKFwiLnVpLWRpYWxvZy10aXRsZWJhci1jbG9zZVwiKS5oaWRlKClcblxuICByZW5kZXJfdGVtcGxhdGU6ICh0ZW1wbGF0ZV9pZCwgY29udGV4dCkgPT5cbiAgICAjIyNcbiAgICAgKiBSZW5kZXIgSGFuZGxlYmFycyBKUyB0ZW1wbGF0ZVxuICAgICMjI1xuICAgIEBkZWJ1ZyBcIsKwwrDCsCBUZW1wb3JhcnlJZGVudGlmaWVyV2lkZ2V0OjpyZW5kZXJfdGVtcGxhdGU6dGVtcGxhdGVfaWQ6I3sgdGVtcGxhdGVfaWQgfSDCsMKwwrBcIlxuXG4gICAgIyBnZXQgdGhlIHRlbXBsYXRlIGJ5IElEXG4gICAgc291cmNlID0gJChcIiMje3RlbXBsYXRlX2lkfVwiKS5odG1sKClcbiAgICByZXR1cm4gdW5sZXNzIHNvdXJjZVxuICAgICMgQ29tcGlsZSB0aGUgaGFuZGxlYmFycyB0ZW1wbGF0ZVxuICAgIHRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKHNvdXJjZSlcbiAgICAjIFJlbmRlciB0aGUgdGVtcGxhdGUgd2l0aCB0aGUgZ2l2ZW4gY29udGV4dFxuICAgIHRlbXBsYXRlKGNvbnRleHQpXG5cbiAgIyMjXG4gIEFqYXggU3VibWl0IHdpdGggYXV0b21hdGljIGV2ZW50IHRyaWdnZXJpbmcgYW5kIHNvbWUgc2FuZSBkZWZhdWx0c1xuICAjIyNcbiAgYWpheF9zdWJtaXQ6IChvcHRpb25zPXt9KSA9PlxuICAgIEBkZWJ1ZyBcIsKwwrDCsCBUZW1wb3JhcnlJZGVudGlmaWVyV2lkZ2V0OjphamF4X3N1Ym1pdCDCsMKwwrBcIlxuXG4gICAgIyBzb21lIHNhbmUgb3B0aW9uIGRlZmF1bHRzXG4gICAgb3B0aW9ucy50eXBlID89IFwiUE9TVFwiXG4gICAgb3B0aW9ucy51cmwgPz0gQGdldF9wb3J0YWxfdXJsKClcbiAgICBvcHRpb25zLmNvbnRleHQgPz0gdGhpc1xuICAgIG9wdGlvbnMuZGF0YVR5cGUgPz0gXCJqc29uXCJcbiAgICBvcHRpb25zLmRhdGEgPz0ge31cbiAgICBvcHRpb25zLl9hdXRoZW50aWNhdG9yID89ICQoXCJpbnB1dFtuYW1lPSdfYXV0aGVudGljYXRvciddXCIpLnZhbCgpXG5cbiAgICBjb25zb2xlLmRlYnVnIFwiPj4+IGFqYXhfc3VibWl0OjpvcHRpb25zPVwiLCBvcHRpb25zXG5cbiAgICAkKHRoaXMpLnRyaWdnZXIgXCJhamF4OnN1Ym1pdDpzdGFydFwiXG4gICAgZG9uZSA9IC0+XG4gICAgICAkKHRoaXMpLnRyaWdnZXIgXCJhamF4OnN1Ym1pdDplbmRcIlxuICAgIHJldHVybiAkLmFqYXgob3B0aW9ucykuZG9uZSBkb25lXG5cbiAgIyMjXG4gIFJldHVybnMgdGhlIHBvcnRhbCB1cmwgKGNhbGN1bGF0ZWQgaW4gY29kZSlcbiAgIyMjXG4gIGdldF9wb3J0YWxfdXJsOiA9PlxuICAgIHVybCA9ICQoXCJpbnB1dFtuYW1lPXBvcnRhbF91cmxdXCIpLnZhbCgpXG4gICAgcmV0dXJuIHVybCBvciB3aW5kb3cucG9ydGFsX3VybFxuXG4gICMjI1xuICBQcmludHMgYSBkZWJ1ZyBtZXNzYWdlIGluIGNvbnNvbGUgd2l0aCB0aGlzIGNvbXBvbmVudCBuYW1lIHByZWZpeGVkXG4gICMjI1xuICBkZWJ1ZzogKG1lc3NhZ2UpID0+XG4gICAgY29uc29sZS5kZWJ1ZyBcIltzZW5haXRlLnBhdGllbnQudGVtcG9yYXJ5X2lkZW50aWZpZXJfd2lkZ2V0XSBcIiwgbWVzc2FnZVxuXG5leHBvcnQgZGVmYXVsdCBUZW1wb3JhcnlJZGVudGlmaWVyV2lkZ2V0Q29udHJvbGxlclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFDQTs7Ozs7QUFvQkE7Ozs7O0FBaUJBO0FBSUE7Ozs7O0FBU0E7Ozs7O0FBbUNBOzs7OztBQXFFQTs7Ozs7QUFTQTs7Ozs7QUFNQTs7Ozs7QUFNQTs7Ozs7QUFNQTs7Ozs7QUFNQTs7Ozs7QUFNQTs7Ozs7QUFPQTs7Ozs7QUFPQTs7Ozs7QUFVQTtBQVdBOzs7Ozs7QUFPQTs7Ozs7OztBQTRDQTtBQTBCQTs7Ozs7QUFpQkE7Ozs7O0FBcUJBOzs7OztBQU9BO0FBOVZBO0FBRUE7QUFDQTs7Ozs7QUFNQTtBQUNBO0FBVkE7QUFDQTtBQUNBO0FBV0E7QUFDQTtBQWZBO0FBQ0E7QUFIQTtBQUFBO0FBQUE7QUF3QkE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FB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\n//# sourceURL=webpack-internal:///./components/temporaryidentifierwidget.coffee\n");

/***/ }),

/***/ "./senaite.patient.js":
/*!****************************!*\
  !*** ./senaite.patient.js ***!
  \****************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _components_temporaryidentifierwidget_coffee__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./components/temporaryidentifierwidget.coffee */ \"./components/temporaryidentifierwidget.coffee\");\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  console.debug(\"*** SENAITE PATIENT JS LOADED ***\"); // Initialize controllers\n\n  window.temporary_identifier_widget = new _components_temporaryidentifierwidget_coffee__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zZW5haXRlLnBhdGllbnQuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zZW5haXRlLnBhdGllbnQuanM/ZmEyNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVGVtcG9yYXJ5SWRlbnRpZmllcldpZGdldENvbnRyb2xsZXIgZnJvbSBcIi4vY29tcG9uZW50cy90ZW1wb3JhcnlpZGVudGlmaWVyd2lkZ2V0LmNvZmZlZVwiXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgY29uc29sZS5kZWJ1ZyhcIioqKiBTRU5BSVRFIFBBVElFTlQgSlMgTE9BREVEICoqKlwiKTtcblxuICAvLyBJbml0aWFsaXplIGNvbnRyb2xsZXJzXG4gIHdpbmRvdy50ZW1wb3JhcnlfaWRlbnRpZmllcl93aWRnZXQgPSBuZXcgVGVtcG9yYXJ5SWRlbnRpZmllcldpZGdldENvbnRyb2xsZXIoKTtcblxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./senaite.patient.js\n");

/***/ }),

/***/ 0:
/*!**********************************!*\
  !*** multi ./senaite.patient.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! ./senaite.patient.js */"./senaite.patient.js");


/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = jQuery;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianF1ZXJ5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwialF1ZXJ5XCI/Y2QwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGpRdWVyeTsiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///jquery\n");

/***/ })

/******/ });